@{
    ViewData["Title"] = "Quản lý Marketing";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    ViewData["Breadcrumb"] = "<li class=\"breadcrumb-item active\">Marketing</li>";
    
    var totalFlashSales = ViewBag.TotalFlashSales ?? 0;
    var activeFlashSales = ViewBag.ActiveFlashSales ?? 0;
    var totalEmailCampaigns = ViewBag.TotalEmailCampaigns ?? 0;
    var sentEmailCampaigns = ViewBag.SentEmailCampaigns ?? 0;
    var totalPushCampaigns = ViewBag.TotalPushCampaigns ?? 0;
    var sentPushCampaigns = ViewBag.SentPushCampaigns ?? 0;
}

<div class="admin-content">
    <!-- Page Header -->
    <div class="admin-page-header">
        <div class="admin-flex-between">
            <div>
                <h1 class="admin-page-title">
                    <i data-lucide="megaphone"></i>
                    Marketing
                </h1>
            </div>
        </div>
    </div>

    <!-- Alert Messages -->
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="admin-alert admin-alert-success">
            <i data-lucide="check-circle"></i>
            <span>@TempData["SuccessMessage"]</span>
        </div>
    }

    <!-- Statistics Cards -->
    <div class="admin-stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
        <div class="admin-stat-card">
            <div class="admin-stat-card-content">
                <div class="admin-stat-card-info">
                    <h3>Flash Sales</h3>
                    <p class="value">@totalFlashSales</p>
                    <p class="change">@activeFlashSales đang diễn ra</p>
                </div>
                <div class="admin-stat-card-icon danger">
                    <i data-lucide="zap"></i>
                </div>
            </div>
        </div>

        <div class="admin-stat-card">
            <div class="admin-stat-card-content">
                <div class="admin-stat-card-info">
                    <h3>Email quảng bá</h3>
                    <p class="value">@totalEmailCampaigns</p>
                    <p class="change">@sentEmailCampaigns đã gửi</p>
                </div>
                <div class="admin-stat-card-icon info">
                    <i data-lucide="mail"></i>
                </div>
            </div>
        </div>

        <div class="admin-stat-card">
            <div class="admin-stat-card-content">
                <div class="admin-stat-card-info">
                    <h3>Thông báo đẩy</h3>
                    <p class="value">@totalPushCampaigns</p>
                    <p class="change">@sentPushCampaigns đã gửi</p>
                </div>
                <div class="admin-stat-card-icon secondary">
                    <i data-lucide="bell"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="admin-card admin-mb-lg">
        <div class="admin-card-header">
            <h3>Hành động nhanh</h3>
        </div>
        <div class="admin-card-body">
            <div class="row g-3">
                <div class="col-md-6 col-lg-4">
                    <div class="admin-card" style="height: 100%; box-shadow: none;">
                        <div class="admin-card-header" style="background: var(--admin-bg);">
                            <h4 style="font-size: 1rem; margin: 0;">
                                <i data-lucide="zap" style="width: 18px; height: 18px;"></i>
                                Quản lý Flash Sales
                            </h4>
                        </div>
                        <div class="admin-card-body">
                            <p style="color: var(--admin-text-light); margin-bottom: var(--spacing-md);">
                                Thiết lập khuyến mãi giờ vàng, sale sốc
                            </p>
                            <div class="admin-flex admin-gap-sm">
                                <a href="/admin/marketing/flashsales" class="admin-btn admin-btn-primary admin-btn-sm">
                                    <i data-lucide="list"></i>
                                    Danh sách (@totalFlashSales)
                                </a>
                                <a href="/admin/marketing/flashsale/create" class="admin-btn admin-btn-success admin-btn-sm">
                                    <i data-lucide="plus"></i>
                                    Tạo mới
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6 col-lg-4">
                    <div class="admin-card" style="height: 100%; box-shadow: none;">
                        <div class="admin-card-header" style="background: var(--admin-bg);">
                            <h4 style="font-size: 1rem; margin: 0;">
                                <i data-lucide="mail" style="width: 18px; height: 18px;"></i>
                                Email Marketing
                            </h4>
                        </div>
                        <div class="admin-card-body">
                            <p style="color: var(--admin-text-light); margin-bottom: var(--spacing-md);">
                                Tạo và gửi chiến dịch email marketing
                            </p>
                            <div class="admin-flex admin-gap-sm">
                                <a href="/admin/marketing/emails" class="admin-btn admin-btn-primary admin-btn-sm">
                                    <i data-lucide="list"></i>
                                    Danh sách (@totalEmailCampaigns)
                                </a>
                                <a href="/admin/marketing/email/create" class="admin-btn admin-btn-success admin-btn-sm">
                                    <i data-lucide="plus"></i>
                                    Tạo mới
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6 col-lg-4">
                    <div class="admin-card" style="height: 100%; box-shadow: none;">
                        <div class="admin-card-header" style="background: var(--admin-bg);">
                            <h4 style="font-size: 1rem; margin: 0;">
                                <i data-lucide="bell" style="width: 18px; height: 18px;"></i>
                                Push Notifications
                            </h4>
                        </div>
                        <div class="admin-card-body">
                            <p style="color: var(--admin-text-light); margin-bottom: var(--spacing-md);">
                                Gửi thông báo đẩy đến khách hàng
                            </p>
                            <div class="admin-flex admin-gap-sm">
                                <a href="/admin/marketing/pushes" class="admin-btn admin-btn-primary admin-btn-sm">
                                    <i data-lucide="list"></i>
                                    Danh sách (@totalPushCampaigns)
                                </a>
                                <a href="/admin/marketing/push/create" class="admin-btn admin-btn-success admin-btn-sm">
                                    <i data-lucide="plus"></i>
                                    Tạo mới
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Auto-hide success messages
        setTimeout(function() {
            var alerts = document.querySelectorAll('.admin-alert');
            alerts.forEach(function(alert) {
                alert.style.transition = 'opacity 0.5s ease';
                alert.style.opacity = '0';
                setTimeout(function() {
                    alert.remove();
                }, 500);
            });
        }, 5000);
    </script>
}
