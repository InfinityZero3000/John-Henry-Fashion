@model ContactViewModel
@{
    ViewData["Title"] = "Liên hệ";
}

<div class="container py-5">
    <h1 class="display-4 text-center mb-5" data-aos="fade-down">Liên hệ với chúng tôi</h1>
    
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert" data-aos="fade-up">
            <i class="fas fa-check-circle me-2"></i>@TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="row">
                <!-- Contact Form -->
                <div class="col-md-8" data-aos="fade-up" data-aos-delay="200">
                    <div class="card shadow-sm h-100">
                        <div class="card-body p-4">
                            <h4 class="card-title mb-4">
                                <i class="fas fa-envelope me-2 text-primary"></i>Gửi tin nhắn
                            </h4>
                            
                            <form asp-action="Index" method="post">
                                <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label asp-for="Name" class="form-label required">Họ và tên</label>
                                            <input asp-for="Name" class="form-control" placeholder="Nhập họ và tên">
                                            <span asp-validation-for="Name" class="text-danger small"></span>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label asp-for="Phone" class="form-label">Số điện thoại</label>
                                            <input asp-for="Phone" class="form-control" placeholder="Nhập số điện thoại">
                                            <span asp-validation-for="Phone" class="text-danger small"></span>
                                        </div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label asp-for="Email" class="form-label required">Email</label>
                                    <input asp-for="Email" class="form-control" placeholder="Nhập email">
                                    <span asp-validation-for="Email" class="text-danger small"></span>
                                </div>

                                <div class="mb-3">
                                    <label asp-for="Subject" class="form-label required">Chủ đề</label>
                                    <input asp-for="Subject" class="form-control" placeholder="Nhập chủ đề">
                                    <span asp-validation-for="Subject" class="text-danger small"></span>
                                </div>

                                <div class="mb-4">
                                    <label asp-for="Message" class="form-label required">Nội dung</label>
                                    <textarea asp-for="Message" class="form-control" rows="6" placeholder="Nhập nội dung liên hệ của bạn..."></textarea>
                                    <span asp-validation-for="Message" class="text-danger small"></span>
                                    <div class="form-text">Tối thiểu 10 ký tự, tối đa 5000 ký tự</div>
                                </div>

                                <button type="submit" class="btn btn-primary btn-lg w-100">
                                    <i class="fas fa-paper-plane me-2"></i>Gửi tin nhắn
                                </button>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Contact Info -->
                <div class="col-md-4" data-aos="fade-up" data-aos-delay="400">
                    <div class="card shadow-sm h-100">
                        <div class="card-body p-4">
                            <h4 class="card-title mb-4">
                                <i class="fas fa-info-circle me-2 text-primary"></i>Thông tin liên hệ
                            </h4>
                            
                            <div class="contact-info">
                                <div class="contact-item mb-3">
                                    <div class="d-flex align-items-start">
                                        <i class="fas fa-map-marker-alt text-primary me-3 mt-1"></i>
                                        <div>
                                            <h6 class="mb-1">Địa chỉ</h6>
                                            <p class="text-muted mb-0">123 Đường ABC, Quận 1<br>TP. Hồ Chí Minh, Việt Nam</p>
                                        </div>
                                    </div>
                                </div>

                                <div class="contact-item mb-3">
                                    <div class="d-flex align-items-start">
                                        <i class="fas fa-phone text-primary me-3 mt-1"></i>
                                        <div>
                                            <h6 class="mb-1">Điện thoại</h6>
                                            <p class="text-muted mb-0">
                                                <a href="tel:+84123456789" class="text-decoration-none">+84 123 456 789</a>
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div class="contact-item mb-3">
                                    <div class="d-flex align-items-start">
                                        <i class="fas fa-envelope text-primary me-3 mt-1"></i>
                                        <div>
                                            <h6 class="mb-1">Email</h6>
                                            <p class="text-muted mb-0">
                                                <a href="mailto:info@johnhenryfashion.com" class="text-decoration-none">info@johnhenryfashion.com</a>
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div class="contact-item">
                                    <div class="d-flex align-items-start">
                                        <i class="fas fa-clock text-primary me-3 mt-1"></i>
                                        <div>
                                            <h6 class="mb-1">Giờ làm việc</h6>
                                            <p class="text-muted mb-0">
                                                Thứ 2 - Chủ nhật<br>
                                                8:00 AM - 10:00 PM
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Support Sections - Full Width -->
    <div class="row mt-5">
        <div class="col-12">
            <!-- FAQ Section -->
            <div id="faq" class="support-section mb-5" data-aos="fade-up">
                <h2 class="section-title mb-4"><i class="fas fa-question-circle me-2"></i>Câu hỏi thường gặp (FAQ)</h2>
                <div class="accordion" id="faqAccordion">
                    <div class="accordion-item">
                        <h3 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                                Làm thế nào để đặt hàng?
                            </button>
                        </h3>
                        <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Bạn có thể đặt hàng trực tuyến qua website bằng cách chọn sản phẩm, thêm vào giỏ hàng và tiến hành thanh toán. Hoặc liên hệ hotline để được hỗ trợ đặt hàng.
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h3 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                                Tôi có thể thanh toán như thế nào?
                            </button>
                        </h3>
                        <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Chúng tôi chấp nhận nhiều hình thức thanh toán: COD (thanh toán khi nhận hàng), chuyển khoản ngân hàng, ví điện tử (Momo, ZaloPay), thẻ tín dụng/ghi nợ.
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h3 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                                Thời gian giao hàng là bao lâu?
                            </button>
                        </h3>
                        <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Thời gian giao hàng từ 2-5 ngày làm việc tùy khu vực. Nội thành HCM và Hà Nội: 1-2 ngày. Các tỉnh khác: 3-5 ngày.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Shopping Guide -->
            <div id="shopping-guide" class="support-section mb-5" data-aos="fade-up">
                <h2 class="section-title mb-4"><i class="fas fa-shopping-bag me-2"></i>Hướng dẫn mua hàng</h2>
                <div class="card">
                    <div class="card-body">
                        <ol class="guide-steps">
                            <li><strong>Bước 1:</strong> Chọn sản phẩm yêu thích và nhấn "Thêm vào giỏ hàng"</li>
                            <li><strong>Bước 2:</strong> Kiểm tra giỏ hàng và điều chỉnh số lượng nếu cần</li>
                            <li><strong>Bước 3:</strong> Nhấn "Thanh toán" và điền thông tin giao hàng</li>
                            <li><strong>Bước 4:</strong> Chọn phương thức thanh toán phù hợp</li>
                            <li><strong>Bước 5:</strong> Xác nhận đơn hàng và chờ nhận hàng</li>
                        </ol>
                    </div>
                </div>
            </div>

            <!-- Return Policy -->
            <div id="return-policy" class="support-section mb-5" data-aos="fade-up">
                <h2 class="section-title mb-4"><i class="fas fa-undo me-2"></i>Chính sách đổi trả</h2>
                <div class="card">
                    <div class="card-body">
                        <h5>Điều kiện đổi trả:</h5>
                        <ul>
                            <li>Sản phẩm còn nguyên tem mác, chưa qua sử dụng</li>
                            <li>Đổi trả trong vòng 7 ngày kể từ ngày nhận hàng</li>
                            <li>Có hóa đơn mua hàng hoặc mã đơn hàng</li>
                            <li>Lỗi do nhà sản xuất hoặc giao nhầm size/màu</li>
                        </ul>
                        <h5 class="mt-4">Quy trình đổi trả:</h5>
                        <ol>
                            <li>Liên hệ bộ phận chăm sóc khách hàng qua hotline hoặc email</li>
                            <li>Gửi sản phẩm về địa chỉ công ty (phí ship khách hàng chịu nếu không phải lỗi sản phẩm)</li>
                            <li>Chúng tôi kiểm tra và xử lý trong 3-5 ngày làm việc</li>
                            <li>Hoàn tiền hoặc đổi sản phẩm mới theo yêu cầu</li>
                        </ol>
                    </div>
                </div>
            </div>

            <!-- Warranty Policy -->
            <div id="warranty" class="support-section mb-5" data-aos="fade-up">
                <h2 class="section-title mb-4"><i class="fas fa-shield-alt me-2"></i>Chính sách bảo hành</h2>
                <div class="card">
                    <div class="card-body">
                        <h5>Thời gian bảo hành:</h5>
                        <ul>
                            <li>Sản phẩm áo sơ mi, quần: 30 ngày</li>
                            <li>Phụ kiện (cà vạt, thắt lưng): 15 ngày</li>
                            <li>Đồng phục công ty: 60 ngày</li>
                        </ul>
                        <h5 class="mt-4">Bảo hành bao gồm:</h5>
                        <ul>
                            <li>Sửa chữa các lỗi về đường may, khuy áo</li>
                            <li>Thay thế nếu lỗi nghiêm trọng không thể sửa</li>
                            <li>Miễn phí công sửa chữa và vật tư</li>
                        </ul>
                        <h5 class="mt-4">Không bảo hành:</h5>
                        <ul>
                            <li>Sản phẩm bị rách, bẩn do sử dụng không đúng cách</li>
                            <li>Sản phẩm đã qua tẩy, giặt bằng hóa chất mạnh</li>
                            <li>Hết thời gian bảo hành</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Shipping Policy -->
            <div id="shipping" class="support-section mb-5" data-aos="fade-up">
                <h2 class="section-title mb-4"><i class="fas fa-truck me-2"></i>Chính sách vận chuyển</h2>
                <div class="card">
                    <div class="card-body">
                        <h5>Phí vận chuyển:</h5>
                        <ul>
                            <li>Miễn phí ship cho đơn hàng từ 500.000đ</li>
                            <li>Phí ship 30.000đ cho đơn dưới 500.000đ (nội thành HCM, HN)</li>
                            <li>Phí ship 50.000đ cho đơn dưới 500.000đ (các tỉnh khác)</li>
                        </ul>
                        <h5 class="mt-4">Thời gian giao hàng:</h5>
                        <table class="table table-bordered mt-3">
                            <thead>
                                <tr>
                                    <th>Khu vực</th>
                                    <th>Thời gian</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Nội thành HCM, Hà Nội</td>
                                    <td>1-2 ngày làm việc</td>
                                </tr>
                                <tr>
                                    <td>Các tỉnh miền Nam, Bắc</td>
                                    <td>2-3 ngày làm việc</td>
                                </tr>
                                <tr>
                                    <td>Các tỉnh miền Trung, Tây Nguyên</td>
                                    <td>3-5 ngày làm việc</td>
                                </tr>
                                <tr>
                                    <td>Vùng sâu, vùng xa</td>
                                    <td>5-7 ngày làm việc</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Size Chart -->
            <div id="size-chart" class="support-section mb-5" data-aos="fade-up">
                <h2 class="section-title mb-4"><i class="fas fa-ruler me-2"></i>Bảng size</h2>
                <div class="card">
                    <div class="card-body">
                        <h5>Áo sơ mi nam:</h5>
                        <table class="table table-bordered table-hover mt-3">
                            <thead class="table-light">
                                <tr>
                                    <th>Size</th>
                                    <th>Chiều cao (cm)</th>
                                    <th>Cân nặng (kg)</th>
                                    <th>Vai (cm)</th>
                                    <th>Ngực (cm)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>S</strong></td>
                                    <td>160-165</td>
                                    <td>50-58</td>
                                    <td>42-44</td>
                                    <td>86-90</td>
                                </tr>
                                <tr>
                                    <td><strong>M</strong></td>
                                    <td>165-170</td>
                                    <td>58-65</td>
                                    <td>44-46</td>
                                    <td>90-94</td>
                                </tr>
                                <tr>
                                    <td><strong>L</strong></td>
                                    <td>170-175</td>
                                    <td>65-72</td>
                                    <td>46-48</td>
                                    <td>94-98</td>
                                </tr>
                                <tr>
                                    <td><strong>XL</strong></td>
                                    <td>175-180</td>
                                    <td>72-80</td>
                                    <td>48-50</td>
                                    <td>98-104</td>
                                </tr>
                                <tr>
                                    <td><strong>XXL</strong></td>
                                    <td>180-185</td>
                                    <td>80-90</td>
                                    <td>50-52</td>
                                    <td>104-110</td>
                                </tr>
                            </tbody>
                        </table>

                        <h5 class="mt-5">Quần tây nam:</h5>
                        <table class="table table-bordered table-hover mt-3">
                            <thead class="table-light">
                                <tr>
                                    <th>Size</th>
                                    <th>Vòng eo (cm)</th>
                                    <th>Vòng mông (cm)</th>
                                    <th>Dài quần (cm)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>29</strong></td>
                                    <td>72-75</td>
                                    <td>88-92</td>
                                    <td>98-100</td>
                                </tr>
                                <tr>
                                    <td><strong>30</strong></td>
                                    <td>75-78</td>
                                    <td>92-96</td>
                                    <td>100-102</td>
                                </tr>
                                <tr>
                                    <td><strong>31</strong></td>
                                    <td>78-82</td>
                                    <td>96-100</td>
                                    <td>102-104</td>
                                </tr>
                                <tr>
                                    <td><strong>32</strong></td>
                                    <td>82-86</td>
                                    <td>100-104</td>
                                    <td>104-106</td>
                                </tr>
                                <tr>
                                    <td><strong>33</strong></td>
                                    <td>86-90</td>
                                    <td>104-108</td>
                                    <td>106-108</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <div class="alert alert-info mt-4">
                            <i class="fas fa-info-circle me-2"></i>
                            <strong>Lưu ý:</strong> Bảng size chỉ mang tính chất tham khảo. Nếu cần tư vấn chi tiết, vui lòng liên hệ hotline để được hỗ trợ chọn size phù hợp.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <style>
        .form-label.required::after {
            content: ' *';
            color: #dc3545;
        }
        
        /* Force equal height columns - only for contact form area */
        .container > .row:first-of-type {
            display: flex;
            flex-wrap: wrap;
        }
        
        .container > .row:first-of-type > [class*='col-'] {
            display: flex;
            flex-direction: column;
        }
        
        .container > .row:first-of-type .card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            height: 100%;
            min-height: 600px; /* Ensure minimum height */
        }
        
        .container > .row:first-of-type .card-body {
            display: flex;
            flex-direction: column;
            flex: 1;
        }
        
        /* Make form take up available space */
        .container > .row:first-of-type .card-body form {
            display: flex;
            flex-direction: column;
            flex: 1;
        }
        
        /* Contact info should fill available space */
        .container > .row:first-of-type .contact-info {
            display: flex;
            flex-direction: column;
            justify-content: space-evenly; /* Changed from space-between to space-evenly */
            flex: 1;
            min-height: 400px; /* Ensure contact items are well-spaced */
        }
        
        .contact-item {
            padding: 1.5rem 0; /* Increased padding for better spacing */
            border-bottom: 1px solid #eee;
        }
        
        .contact-item:first-child {
            padding-top: 0;
        }
        
        .contact-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }
        
        .contact-item h6 {
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }
        
        .contact-item p {
            margin-bottom: 0;
            line-height: 1.6;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        /* Support Sections */
        .support-section {
            scroll-margin-top: 100px;
        }

        .section-title {
            color: #CE193A;
            font-weight: 700;
            padding-bottom: 10px;
            border-bottom: 3px solid #CE193A;
        }

        .support-section .card {
            min-height: auto;
            border: 1px solid #ddd;
            height: auto;
        }

        .support-section .card-body {
            height: auto;
            padding: 1.5rem;
        }

        .support-section .card:hover {
            transform: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .support-section h5 {
            color: #CE193A;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .support-section h5:first-child {
            margin-top: 0;
        }
        
        .support-section ul,
        .support-section ol {
            line-height: 2;
            padding-left: 1.5rem;
        }
        
        .support-section ul li,
        .support-section ol li {
            margin-bottom: 0.75rem;
        }

        .guide-steps {
            line-height: 2.5;
            font-size: 1.05rem;
        }

        .guide-steps li {
            margin-bottom: 1rem;
        }

        .accordion-button {
            font-weight: 600;
            color: #333;
        }

        .accordion-button:not(.collapsed) {
            background-color: #CE193A;
            color: white;
        }

        .accordion-button:not(.collapsed)::after {
            filter: brightness(0) invert(1);
        }

        .accordion-button:focus {
            box-shadow: 0 0 0 0.25rem rgba(206, 25, 58, 0.25);
        }

        .table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }

        .table-hover tbody tr:hover {
            background-color: rgba(206, 25, 58, 0.05);
        }
        
        /* Responsive adjustments */
        @@media (max-width: 767px) {
            .card {
                min-height: auto;
            }
            .contact-info {
                min-height: auto;
            }
        }
    </style>
}

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script>
        // Character counter for message textarea
        const messageTextarea = document.querySelector('textarea[name="Message"]');
        if (messageTextarea) {
            const maxLength = 5000;
            const minLength = 10;
            
            // Create counter element
            const counter = document.createElement('small');
            counter.className = 'form-text text-muted';
            messageTextarea.parentNode.appendChild(counter);
            
            function updateCounter() {
                const currentLength = messageTextarea.value.length;
                counter.textContent = `${currentLength}/${maxLength} ký tự`;
                
                if (currentLength < minLength) {
                    counter.className = 'form-text text-warning';
                } else if (currentLength > maxLength * 0.9) {
                    counter.className = 'form-text text-danger';
                } else {
                    counter.className = 'form-text text-muted';
                }
            }
            
            messageTextarea.addEventListener('input', updateCounter);
            updateCounter(); // Initial call
        }
        
        // GSAP animations - only fade in, no vertical movement to maintain layout
        gsap.from(".card", { 
            duration: 0.8, 
            opacity: 0, 
            ease: "power2.out",
            stagger: 0.15,
            clearProps: "all" // Clear all props after animation to prevent layout issues
        });
    </script>
}
